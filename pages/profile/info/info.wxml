<!-- 我的信息页面 -->
<view class="container">
  <!-- 用户头像区域 -->
  <view class="card avatar-section">
    <view class="avatar-container">
      <image class="avatar" src="{{userInfo.avatar_url || defaultAvatarUrl}}" mode="aspectFill"></image>
      <view class="avatar-info">
        <text class="username">{{userInfo.username}}</text>
        <text class="user-role">普通用户</text>
      </view>
    </view>
  </view>

  <!-- 账号信息 -->
  <view class="card">
    <view class="section-title">账号信息</view>
    
    <!-- 登录账号 -->
    <view class="form-item">
      <text class="label">登录账号</text>
      <input 
        class="input" 
        value="{{userInfo.username}}" 
        bindinput="onUsernameInput"
        placeholder="请输入新账号"
        maxlength="20"
      />
      <text class="error-text" wx:if="{{usernameError}}">{{usernameError}}</text>
    </view>

    <!-- 登录密码 -->
    <view class="form-item">
      <text class="label">修改密码</text>
      <input 
        class="input" 
        type="password" 
        value="{{passwordForm.oldPassword}}" 
        bindinput="onOldPasswordInput"
        placeholder="请输入原密码"
      />
      <input 
        class="input" 
        type="password" 
        value="{{passwordForm.newPassword}}" 
        bindinput="onNewPasswordInput"
        placeholder="请输入新密码"
      />
      <input 
        class="input" 
        type="password" 
        value="{{passwordForm.confirmPassword}}" 
        bindinput="onConfirmPasswordInput"
        placeholder="确认新密码"
      />
      <text class="error-text" wx:if="{{passwordError}}">{{passwordError}}</text>
    </view>
  </view>

  <!-- 个人信息 -->
  <view class="card">
    <view class="section-title">个人信息</view>
    
    <!-- 昵称 -->
    <view class="form-item">
      <text class="label">昵称</text>
      <input 
        class="input" 
        value="{{userInfo.nickname}}" 
        bindinput="onNicknameInput"
        placeholder="请输入昵称"
        maxlength="20"
      />
    </view>

    <!-- 头像上传 -->
    <view class="form-item">
      <text class="label">头像</text>
      <view class="avatar-upload">
        <view class="avatar-preview" bindtap="chooseAvatar">
          <image 
            class="avatar-image" 
            src="{{userInfo.avatar_url}}" 
            mode="aspectFill"
          />
          <view class="avatar-overlay">
            <text class="upload-text">点击上传</text>
          </view>
        </view>
        <view class="avatar-actions">
          <button class="btn-upload" bindtap="chooseAvatar">选择头像</button>
          <button class="btn-clear" bindtap="clearAvatar" wx:if="{{userInfo.avatar_url}}">清除头像</button>
        </view>
      </view>
    </view>

    <!-- 邮箱 -->
    <view class="form-item">
      <text class="label">邮箱</text>
      <input 
        class="input" 
        value="{{userInfo.email}}" 
        bindinput="onEmailInput"
        placeholder="请输入邮箱地址"
      />
      <text class="error-text" wx:if="{{emailError}}">{{emailError}}</text>
    </view>

    <!-- 手机号 -->
    <view class="form-item">
      <text class="label">手机号</text>
      <input 
        class="input" 
        value="{{userInfo.phone}}" 
        bindinput="onPhoneInput"
        placeholder="请输入手机号"
        maxlength="11"
      />
      <text class="error-text" wx:if="{{phoneError}}">{{phoneError}}</text>
    </view>
  </view>

  <!-- 操作按钮 -->
  <view class="card">
    <button class="btn-primary" bindtap="saveInfo" disabled="{{saving}}">
      {{saving ? '保存中...' : '保存信息'}}
    </button>
    <button class="btn-secondary" bindtap="resetForm">重置</button>
  </view>
</view>
